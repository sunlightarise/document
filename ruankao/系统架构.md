# 系统架构

## 软件架构概念

### 软件架构概念-软件架构模型

* 逻辑视图
  最终用户：功能需求 （UML: 逻辑视图）
  
* 开发视图
  编程人员：软件管理（URL：实现视图）

* 进程视图
  系统集成人员：性能可拓充性，吞吐量等（URL：进程视图）

* 物理视图
  系统工程人员：系统拓扑，安装，通讯等（URL：部署视图）
 
* 场景 （UML: 用例视图）


## 架构描述语言（ADL）

体系描述语言（architecture description language, 简称 ADL），支持：构件、连接子及其配置的描述语言。

## 软件架构风格

* 数据流风格：批处理序列，管道-过滤
* 调用/返回风格：主程序/子程序、面向对象、层次结构
* 独立构件风格：进程通讯、事件驱动系统（隐式调用）
* 虚拟机风格：解释器、基于规则的系统
* 仓库风格：数据库系统、超文本系统、黑板系统

### 软件架构风格-数据流风格
* 批处理序列
  数据必须完整的，以整体的方式传输。
 
* 管道-过滤器
  早起编译器就是采用这种风格，要一步一步的处理，均可考虑采用此架构风格。

### 软件架构风格-调用/返回风格

* 主程序/子程序
* 面向对象
* 层次结构
  构件组织成一个层次结构，连接件通过决定层间如何交互的协议来定义。每层为上一层提供服务，
使用下一层的服务，只能看到自己临接的层。通过层次结构，可以将大的问题分解为若干个逐渐的小问题逐步解决，
可以隐藏问题的复杂度，修改某一层，最多影响其相邻的两层（通常只能影响上层）

#### 层次结构
优点
* 这种风格支持基于可增加抽象层的设计，将一个复杂问题分解成一个增量步骤序列的实现

### 独立构件风格

#### 进程通讯

#### 事件驱动系统（隐式调用）
按钮控件。断点调试，编辑器

#### 软件架构风格-虚拟机风格
  有没有需要自定义业务流程的场景，如：游戏自定义地图，OA自定义审批流程
  
* 解释器（任务持续依赖，动态调整）
  解释器通常包括一个完成解释工作的解释引擎，一个包含将被解释的代码的存储区、
一个记录引擎当前工作状态的数据结构，以及记录一个源代码被解释执行的进度的数据结构。具有解释器风格的软件
中含有一个虚拟机，可以仿真的执行过程和一些关键应用，其确定是执行效率比较低

* 基于规则的系统
  基于规则的系统包括规则集、规则解释器、规则/数据选择器和工作内存，一般用在人工智能领域的DSS中。
  知识性质：通过历史数据进行大量分析，产生一些对决策有帮助的条款与规则。

#### 软件架构风格-仓库风格（以数据为中心的风格/数据共享风格）
* 数据库系统（DBMS）
  构件主要有两大类，一类是共享数据源，保存当前系统的数据状态；另一类是多个独立处理单元，处理单元对数据元素进行操作
  中心一个数据源，其他应用系统协作处理

* 黑板系统
  信号处理、问题规划（例子：语音处理）
  
* 超文本系统
  现代集成编译环境一般采用这种架构风格 隐式调用（事件驱动）
  
  
#### 软件架构风格-闭环控制架构（过程控制）

适合于嵌入式系统，涉及连续的动作状态


### 软件架构风格-层次架构风格

两层 (C/S)=> 三层 (C/S) => 三层 (B/S) => 混合架构 


#### 软件架构风格-层次架构风格

* 三层B/S
  * 表现层
    * MVC （在表示层级）
    * MVP
    * MVVM
   * 中间层
   * 数据访问层
     * ORM
   * 数据架构层

##### 软件架构风格-MVC架构风格

* Model (模型)是应用程序中用于**处理应用程序数据逻辑的部分**。通常模型对象负责在数据库中存储数据。

* View （视图）是应用程序中**处理数据显示的部分**。通常视图是依据模型数据的创建的。

* Controller (控制器) 是应用程序中**处理用户交互的部分**。通常控制器负责从视图读取数据，
控制用户输入，并向模型发送数据。

* J2EE体系结构中

  视图（View）JSP
  控制（Controller）Servlet
  模型（Model）Entity Bean, Session Bean

严格分层，只能相邻的层次之间通讯、非严格分层，跨层交换信息。

* 主动MVC

* 被动MVC 


##### 软件架构风格-MVP架构风格

##### 软件架构风格-MVVM架构风格

##### 软件架构风格-富互联网应用（RIX）

B/S 表现能力比较差
B/S 零客户端
富客户端
如：flex, html5, Bindows

##### 软件架构风格-基于服务的架构（SOA）

服务是一种为了满足某项业务需求的操作、规则等的逻辑组合，它包含一系列有序活动的交互
，为实现用户目标提供支持

服务是一种标准化程度更高的构件

##### SOA - 关键技术

* 服务发现
  * UDDI、DISCO
* 描述服务
  * WSDL、XML Schema
* 消息格式层
  * SOAP REST
* 编码格式层
  * XML （DOM，SAX）
* 传输协议层
  * HTTP、TCP/IP、SMTP 等


实现SOA：两大技术
Web 服务 （web service）
ESB   企业服务总线

* SOA - 实现方式 Web Service 
  * 服务请求者
  * 服务注册中心 (服务描述) （百度搜索引擎）
  * 服务提供者

软考考生 => 希赛网 (静态绑定)
  * 底层传输层
  * 服务通信协议层
  * 服务描述层
  * 服务层
  * 业务流程
  * 服务注册层
  

###### SOA - 关键技术- XML

###### SOA - 关键技术- REST

###### SOA - 关键技术- WSDL
  用来做服务的定义
  
###### SOA - 关键技术- ESB
  消息中间件
  服务总线 （中介模式）
  
  它是面向服务的架构（SOA）的一种
  实现方式

ESB 是总线， web service 是单个节点

##### SOA - 服务注册表


#### 软件架构风格 - 微服务

* 特点
  * 小、且专注于做一件事情
  * 轻量级的通信机制
  * 松耦合、独立部署
    * 容器技术来实现快速部署 docker , k8s
    * 自动集成 jenkins 来做 ci/cd

#### 软件架构风格 - 微服务与SOA

|  微服务 | SOA | 
| :------| :------ | 
| 能拆分就拆分   | 是整体的，服务能放在一起的就放在一起 | 
| 纵向业务划分   | 是水平分多层 |
| 由单一组织负责 | 按层级划分不同部分的组织 |
| 细粒度        | 粗粒度 |
| 两句话就可以解释明白 | 几百字相当于SOA的目录 |
| 独立的子公司 | 类似大公司里面划分了一些业务单元（BU） |
| 组件小 | 存在较复杂的组件 |
| 业务逻辑存在于每一个服务中 | 业务逻辑横跨多个业务领域 |
| 使用轻量级的通讯方式，如HTTP | 企业服务总线（ESB从当了服务之间通讯的角色） |
