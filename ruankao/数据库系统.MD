# 数据库系统

* **数据库模式**
* ER模型
* **关系代数**
* 元组演算
* **规范化理论** 
* 并发控制
* 数据库完整性约束
* 分布式数据库
* 数据仓库与数据挖掘
 
### 三级模式-两层映射
  是典型的**分层架构**

* 用户级数据库
* 用户视图
* 概念级数据库
* DBA视图
* 物理数据库
* 内部视图

* 视图 （外模式）【应用程序 => 视图 => 基本表】

  * 数据库视图
    它使一个虚拟表（逻辑上的表），其内容由查询定义（**仅保存SQl查询语句**）同真实的表一样，
    视图包含一系列带有名称的列和行数据，但是，视图并没有真正存储这些数据，
    而是通过查询原始表动态生成所需要的数据。
    
  * 视图的优点
    * **视图能简化用户操作（多表关联查询结果）**
    * 视图使用户能以多重角度看待同一数据
    * **视图对重构数据库提供了一定程度的逻辑独立性**
    * 视图可以对机密数据提供安全保护
    
  * 物化视图
    * 他不是传统意义上的视图，是实体化视图，其本身会存储数据。同事当原始表中的数据更新时，物化视图也会更新。
    **更新原始表，效率会降低**
    
* 基本表 （概念模式）
* 物理文件（内模式）

目标：数据库变化，不带来应用程序的变化（**两级映射**）
 
**考点：
   外模式（视图）、概念模式（基本表）、内模式（物理文件）
   修改 外模式-概念模式映射 可以做到修改基本表应用程序不变**

 
### 数据库设计过程
* 需求分析
  * 数据流图 （DFD）
  * 数据字典（DD）
  * 需求说明书（SRS）
  
* 概念结构设计
  * ER模型，（实体、联系、属性）
  
* 逻辑结构设计
  * 关系模式
  
* 物理设计

* **和软件工程设计过程对比** 
和软件工程中的说法有冲突
  在软件工程中，ER模型，是需求分析阶段的数据建模工具
  数据库中，ER模式是概念结构设计的产物

### ER模型
* 需求分析
* 概念结构设计
  * 抽象数据
  * 设计局部的ER模型
  * 合并局部模型，消除冲突
  * 重构优化、消除冗余
* 逻辑设计

* **如何将ER模型转换为关系模式**
  * 每个实体要单独转换为一个关系模式
  * 转换时，每个属性，就是一个字段
  如： 学生（学号，姓名，性别，年龄）
  

* **一个实体转换为一个单独的关系模式**
  * 1:1 联系
  * 1:n 联系
    可以单独转，也可以吧联系与N端合并
  * m:n 联系
    必须单独转关系模式
  
### 关系代数
* 并
* 交 
* 差 （结果，在S1中，但不在S2中的记录）
  A-B =（a, b）
* 笛卡尔积
  * S1和S2 属性 = S1属性 与 S2属性
  * 结果集的记录数=S1记录数 * S2记录数
* 投影
  * 获取列
* 选择
  * 满足条件的记录（行）
    筛选（查询符合条件的）行
* 连接
  * 自然连接
    * 对S1 与S2 的相同属性（相同列），做等值连。
    * 去掉重复属性。  

### 规范化理论
* 价值和用途
  * 非规范化的关系模式，可能存在的问题包括：数据冗余，更新异常，插入异常，删除异常。
* 函数依赖
  设R(U)是属性U上的一个关系模式，X和Y是U的子集，r为R的任一关系，如果对于r中的任意两个元祖u,v,只要有
  u[X]=u[Y],则称X函数决定Y,或称Y函数依赖于X,记为X-Y
关系模式：R(A, B, C )
**部分函数依赖**
依赖集1: (AB -> D, A -> C)
**传递函数依赖**
依赖集2：(A->B, B->C)

* 键
  * 候选键，（唯一标识元祖（记录），且无冗余） 入度为0
  * 主键， （多个候选键中选一个）
  * 外键 （其他关系的主键）

* 候选键的
总结：
 1、入度为0 的键，是候选键 （如果他不能被选择则他就成了 信息孤岛）
 2、即有入度，也有出度的节点

* 范式
  插入异常、删除异常、数据冗余
  逐步优化、以解决
  * 1NF 属性都是不可分的原子值
  * 2NF 消除非属性对候选键的部分依赖
    第二范式（2NF）：当且仅当实体E是第一范式（1NF），且每一个**非主属性完全依赖主键**(不存在部分依赖)时
则称实体E是第二范式。
  * 3NF 消除非主属性对候选键的传依赖
    第三范式（3NF）：当且仅当实体E是第二范式（1NF），且E中没有**非主属性传递依赖**于码，则称实体E是第三范式
  * BCNF消除主属性对候选键的部分和传递依赖
    BC 范式（BCNF）：设R是一个关系模式，F是他的依赖集，
    R属于BCNF当且仅当其F中每个一阿里的决定因素必定包含R的某个候选码。
    
